#!/bin/bash

git submodule deinit -f .
git submodule update --init --recursive

cd dwm || exit
make clean && \
    rm -f config.h && \
    rm -f ./*.rej ./*.orig

patches=(../patches/dwm-*)
patches+=(../patches/dwm_*)

for p in "${patches[@]}"; do
  printf "patching: %s" "$p"
  patch -p1 < "$p" || exit 1
done

make && \
    sudo make install && \
    rm -f ./*.rej ./*.orig
